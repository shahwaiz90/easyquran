<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Listen to Quran Recitations Online | Easy Quran</title>
  <meta name="title" content="Listen to Quran Recitations Online | Easy Quran">
  <meta name="description"
    content="Listen to beautiful Quran recitations by world-renowned Qaris. High-quality audio with translation access, completely ad-free for a peaceful listening experience.">
  <meta name="keywords"
    content="listen Quran online, Quran mp3, Quran recitation, world renowned Qaris, Holy Quran audio, ad-free Quran audio">
  <meta name="author" content="Easy Quran">
  <link rel="canonical" href="https://easyquran.app/listenquran.html" />

  <!-- Open Graph -->
  <meta property="og:title" content="Listen to Quran Recitations Online - Easy Quran">
  <meta property="og:description"
    content="Streams high-quality audio recitations of the Holy Quran for free with the Easy Quran app.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://easyquran.app/listenquran.html">
  <meta property="og:image" content="https://easyquran.app/newappicon.webp">
  <meta property="og:site_name" content="Easy Quran">
  <meta property="og:locale" content="en_US">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Listen to Quran Recitations | Easy Quran App">
  <meta name="twitter:description" content="High-quality, ad-free Quran audio recitations by top Qaris.">
  <meta name="twitter:image" content="https://easyquran.app/newappicon.webp">

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://easyquran.app/"
    },{
      "@type": "ListItem",
      "position": 2,
      "name": "Listen Quran",
      "item": "https://easyquran.app/listenquran.html"
    }]
  }
  </script>

  <link rel="stylesheet" href="css/global.css">
  <script src="js/components.js" defer></script>

  <style>
    /* Override global body to keep this page dark */
    body {
      background: #004D40 !important;
      color: #fff !important;
    }

    /* Ensure content sits above decorations */
    .container {
      position: relative;
      z-index: 10;
    }

    * {
      box-sizing: border-box;
    }

    /* Header styles removed, using eq-header */

    /* Nav styles removed */

    /* PAGE */
    h1 {
      text-align: center;
      margin: 22px 0 6px;
    }

    .subtitle {
      text-align: center;
      opacity: .85;
      margin-bottom: 18px;
    }

    /* SEARCH + SELECTORS */
    .top-controls {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 18px;
    }

    input,
    select {
      padding: 10px 14px;
      border-radius: 10px;
      border: none;
      font-size: 14px;
      outline: none;
    }

    input {
      min-width: 260px;
    }

    /* PLAYER */
    .player {
      background: linear-gradient(135deg, #00695C, #004D40);
      border: 1px solid rgba(255, 255, 255, .12);
      border-radius: 18px;
      padding: 18px;
      margin: 0 auto 18px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, .25);
    }

    .player-top {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 12px;
      flex-wrap: wrap;
    }

    .track-title {
      font-size: 18px;
      font-weight: 700;
      margin: 0 0 6px;
    }

    .track-sub {
      font-size: 13px;
      opacity: .85;
      margin: 0;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 12px;
      background: rgba(255, 255, 255, .12);
      border: 1px solid rgba(255, 255, 255, .12);
      font-size: 13px;
      user-select: none;
    }

    .bar {
      height: 10px;
      background: rgba(255, 255, 255, .25);
      border-radius: 999px;
      margin: 14px 0 10px;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .fill {
      position: absolute;
      inset: 0;
      width: 0%;
      background: #fff;
      border-radius: 999px;
    }

    .time {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      opacity: .85;
    }

    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      margin-top: 12px;
      flex-wrap: wrap;
      /* âœ… allow wrapping */
      max-width: 100%;
    }


    .btn {
      width: 46px;
      height: 46px;
      min-width: 46px;
      min-height: 46px;
      padding: 0;
      /* Ensure no browser padding */
      flex: 0 0 auto;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      font-size: 18px;
      background: rgba(255, 255, 255, .18);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform .12s ease, background .12s ease;
    }

    .btn:hover {
      transform: translateY(-1px);
      background: rgba(255, 255, 255, .24);
    }

    .btn:active {
      transform: translateY(0px);
    }

    .btn-play {
      width: 62px;
      height: 62px;
      min-width: 62px;
      min-height: 62px;
      /* ğŸ”‘ fixed size */
      flex: 0 0 auto;
      /* ğŸ”‘ never stretch */
      background: #fff;
      color: #004D40;
      font-size: 22px;
    }

    .btn-play:hover {
      background: #fff;
    }

    .btn-active {
      background: #fff !important;
      color: #004D40 !important;
    }

    .btn-wide {
      width: auto;
      height: 46px;
      min-height: 46px;
      flex: 0 0 auto;
      /* ğŸ”‘ never stretch */
      border-radius: 14px;
      padding: 0 14px;
      font-size: 14px;
      white-space: nowrap;
    }

    /* GRID */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 16px;
      padding-bottom: 40px;
    }

    .card {
      background: rgba(255, 255, 255, .12);
      border-radius: 14px;
      padding: 14px;
      cursor: pointer;
      position: relative;
      border: 1px solid rgba(255, 255, 255, .10);
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }

    .card:hover {
      transform: translateY(-3px);
      background: rgba(255, 255, 255, .16);
      border-color: rgba(255, 255, 255, .18);
    }

    .card.playing {
      border: 2px solid #fff;
      background: rgba(255, 255, 255, .18);
    }

    .num {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: rgba(255, 255, 255, .22);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
    }

    .ar {
      font-size: 20px;
      direction: rtl;
      margin: 6px 0;
    }

    .meta {
      font-size: 13px;
      opacity: .85;
    }

    /* Footer styles removed */

    @media (max-width: 640px) {

      .controls {
        gap: 10px;
      }

      /* Move download button to its own row */
      .btn-wide {
        width: 100%;
        justify-content: center;
      }

    }
  </style>

  

  

  
  <!-- Google Analytics & Tag Manager (Deferred 2s for Performance) -->
  <script>
    window.addEventListener('load', function () {
      setTimeout(function () {
        // Load GTAG
        var gtagScript = document.createElement('script');
        gtagScript.async = true;
        gtagScript.src = 'https://www.googletagmanager.com/gtag/js?id=G-5T5Y28ND45';
        document.head.appendChild(gtagScript);

        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-5T5Y28ND45');

        // Load GTM
        (function (w, d, s, l, i) {
          w[l] = w[l] || []; w[l].push({
            'gtm.start':
              new Date().getTime(), event: 'gtm.js'
          }); var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
              'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-55CXTQTQ');
      }, 2000);
    });
  </script>

  <!-- Mobile Browser & PWA Compatibility -->
  <link rel="apple-touch-icon" href="newappicon.webp">
  <meta name="theme-color" content="#004D40">
</head>

<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-55CXTQTQ" height="0" width="0"
      style="display:none;visibility:hidden"></iframe>
  </noscript>

  <eq-header active="listen"></eq-header>

  <main class="container">
    <h1>Listen to the Holy Quran</h1>
    <div class="subtitle">Recitation by Mishary Rashid Al-Afasy</div>

    <div class="top-controls">
      <input id="search" placeholder="ğŸ” Search Surah by name or number (e.g., 113)" />
      <select id="reciter">
        <option value="afasy">ğŸ™ Mishary Al-Afasy</option>
      </select>
    </div>

    <div id="player" class="player"></div>
    <div id="grid" class="grid"></div>
  </main>

  <eq-footer></eq-footer>

  <audio id="audio" preload="metadata"></audio>

  <script>
    /* ===== Surah list ===== */
    const surahs = [
      ["Al-Fatihah", "Ø§Ù„ÙØ§ØªØ­Ø©"], ["Al-Baqarah", "Ø§Ù„Ø¨Ù‚Ø±Ø©"], ["Ali 'Imran", "Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†"],
      ["An-Nisa", "Ø§Ù„Ù†Ø³Ø§Ø¡"], ["Al-Ma'idah", "Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©"], ["Al-An'am", "Ø§Ù„Ø£Ù†Ø¹Ø§Ù…"],
      ["Al-A'raf", "Ø§Ù„Ø£Ø¹Ø±Ø§Ù"], ["Al-Anfal", "Ø§Ù„Ø£Ù†ÙØ§Ù„"], ["At-Tawbah", "Ø§Ù„ØªÙˆØ¨Ø©"],
      ["Yunus", "ÙŠÙˆÙ†Ø³"], ["Hud", "Ù‡ÙˆØ¯"], ["Yusuf", "ÙŠÙˆØ³Ù"], ["Ar-Ra'd", "Ø§Ù„Ø±Ø¹Ø¯"],
      ["Ibrahim", "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…"], ["Al-Hijr", "Ø§Ù„Ø­Ø¬Ø±"], ["An-Nahl", "Ø§Ù„Ù†Ø­Ù„"],
      ["Al-Isra", "Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡"], ["Al-Kahf", "Ø§Ù„ÙƒÙ‡Ù"], ["Maryam", "Ù…Ø±ÙŠÙ…"],
      ["Taha", "Ø·Ù‡"], ["Al-Anbya", "Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡"], ["Al-Hajj", "Ø§Ù„Ø­Ø¬"],
      ["Al-Mu'minun", "Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†"], ["An-Nur", "Ø§Ù„Ù†ÙˆØ±"], ["Al-Furqan", "Ø§Ù„ÙØ±Ù‚Ø§Ù†"],
      ["Ash-Shu'ara", "Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡"], ["An-Naml", "Ø§Ù„Ù†Ù…Ù„"], ["Al-Qasas", "Ø§Ù„Ù‚ØµØµ"],
      ["Al-'Ankabut", "Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª"], ["Ar-Rum", "Ø§Ù„Ø±ÙˆÙ…"], ["Luqman", "Ù„Ù‚Ù…Ø§Ù†"],
      ["As-Sajdah", "Ø§Ù„Ø³Ø¬Ø¯Ø©"], ["Al-Ahzab", "Ø§Ù„Ø£Ø­Ø²Ø§Ø¨"], ["Saba", "Ø³Ø¨Ø¥"],
      ["Fatir", "ÙØ§Ø·Ø±"], ["Ya-Sin", "ÙŠØ³"], ["As-Saffat", "Ø§Ù„ØµØ§ÙØ§Øª"],
      ["Sad", "Øµ"], ["Az-Zumar", "Ø§Ù„Ø²Ù…Ø±"], ["Ghafir", "ØºØ§ÙØ±"],
      ["Fussilat", "ÙØµÙ„Øª"], ["Ash-Shuraa", "Ø§Ù„Ø´ÙˆØ±Ù‰"], ["Az-Zukhruf", "Ø§Ù„Ø²Ø®Ø±Ù"],
      ["Ad-Dukhan", "Ø§Ù„Ø¯Ø®Ø§Ù†"], ["Al-Jathiyah", "Ø§Ù„Ø¬Ø§Ø«ÙŠØ©"], ["Al-Ahqaf", "Ø§Ù„Ø£Ø­Ù‚Ø§Ù"],
      ["Muhammad", "Ù…Ø­Ù…Ø¯"], ["Al-Fath", "Ø§Ù„ÙØªØ­"], ["Al-Hujurat", "Ø§Ù„Ø­Ø¬Ø±Ø§Øª"],
      ["Qaf", "Ù‚"], ["Adh-Dhariyat", "Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª"], ["At-Tur", "Ø§Ù„Ø·ÙˆØ±"],
      ["An-Najm", "Ø§Ù„Ù†Ø¬Ù…"], ["Al-Qamar", "Ø§Ù„Ù‚Ù…Ø±"], ["Ar-Rahman", "Ø§Ù„Ø±Ø­Ù…Ù†"],
      ["Al-Waqi'ah", "Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©"], ["Al-Hadid", "Ø§Ù„Ø­Ø¯ÙŠØ¯"], ["Al-Mujadila", "Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©"],
      ["Al-Hashr", "Ø§Ù„Ø­Ø´Ø±"], ["Al-Mumtahanah", "Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©"], ["As-Saf", "Ø§Ù„ØµÙ"],
      ["Al-Jumu'ah", "Ø§Ù„Ø¬Ù…Ø¹Ø©"], ["Al-Munafiqun", "Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†"],
      ["At-Taghabun", "Ø§Ù„ØªØºØ§Ø¨Ù†"], ["At-Talaq", "Ø§Ù„Ø·Ù„Ø§Ù‚"], ["At-Tahrim", "Ø§Ù„ØªØ­Ø±ÙŠÙ…"],
      ["Al-Mulk", "Ø§Ù„Ù…Ù„Ùƒ"], ["Al-Qalam", "Ø§Ù„Ù‚Ù„Ù…"], ["Al-Haqqah", "Ø§Ù„Ø­Ø§Ù‚Ø©"],
      ["Al-Ma'arij", "Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬"], ["Nuh", "Ù†ÙˆØ­"], ["Al-Jinn", "Ø§Ù„Ø¬Ù†"],
      ["Al-Muzzammil", "Ø§Ù„Ù…Ø²Ù…Ù„"], ["Al-Muddaththir", "Ø§Ù„Ù…Ø¯Ø«Ø±"], ["Al-Qiyamah", "Ø§Ù„Ù‚ÙŠØ§Ù…Ø©"],
      ["Al-Insan", "Ø§Ù„Ø¥Ù†Ø³Ø§Ù†"], ["Al-Mursalat", "Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª"], ["An-Naba", "Ø§Ù„Ù†Ø¨Ø£"],
      ["An-Nazi'at", "Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª"], ["'Abasa", "Ø¹Ø¨Ø³"], ["At-Takwir", "Ø§Ù„ØªÙƒÙˆÙŠØ±"],
      ["Al-Infitar", "Ø§Ù„Ø¥Ù†ÙØ·Ø§Ø±"], ["Al-Mutaffifin", "Ø§Ù„Ù…Ø·ÙÙÙŠÙ†"], ["Al-Inshiqaq", "Ø§Ù„Ø¥Ù†Ø´Ù‚Ø§Ù‚"],
      ["Al-Buruj", "Ø§Ù„Ø¨Ø±ÙˆØ¬"], ["At-Tariq", "Ø§Ù„Ø·Ø§Ø±Ù‚"], ["Al-A'la", "Ø§Ù„Ø£Ø¹Ù„Ù‰"],
      ["Al-Ghashiyah", "Ø§Ù„ØºØ§Ø´ÙŠØ©"], ["Al-Fajr", "Ø§Ù„ÙØ¬Ø±"], ["Al-Balad", "Ø§Ù„Ø¨Ù„Ø¯"],
      ["Ash-Shams", "Ø§Ù„Ø´Ù…Ø³"], ["Al-Layl", "Ø§Ù„Ù„ÙŠÙ„"], ["Ad-Duhaa", "Ø§Ù„Ø¶Ø­Ù‰"],
      ["Ash-Sharh", "Ø§Ù„Ø´Ø±Ø­"], ["At-Tin", "Ø§Ù„ØªÙŠÙ†"], ["Al-'Alaq", "Ø§Ù„Ø¹Ù„Ù‚"],
      ["Al-Qadr", "Ø§Ù„Ù‚Ø¯Ø±"], ["Al-Bayyinah", "Ø§Ù„Ø¨ÙŠÙ†Ø©"], ["Az-Zalzalah", "Ø§Ù„Ø²Ù„Ø²Ù„Ø©"],
      ["Al-'Adiyat", "Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª"], ["Al-Qari'ah", "Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©"], ["At-Takathur", "Ø§Ù„ØªÙƒØ§Ø«Ø±"],
      ["Al-'Asr", "Ø§Ù„Ø¹ØµØ±"], ["Al-Humazah", "Ø§Ù„Ù‡Ù…Ø²Ø©"], ["Al-Fil", "Ø§Ù„ÙÙŠÙ„"],
      ["Quraysh", "Ù‚Ø±ÙŠØ´"], ["Al-Ma'un", "Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†"], ["Al-Kawthar", "Ø§Ù„ÙƒÙˆØ«Ø±"],
      ["Al-Kafirun", "Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†"], ["An-Nasr", "Ø§Ù„Ù†ØµØ±"], ["Al-Masad", "Ø§Ù„Ù…Ø³Ø¯"],
      ["Al-Ikhlas", "Ø§Ù„Ø¥Ø®Ù„Ø§Øµ"], ["Al-Falaq", "Ø§Ù„ÙÙ„Ù‚"], ["An-Nas", "Ø§Ù„Ù†Ø§Ø³"]
    ];

    /* ===== DOM ===== */
    const audio = document.getElementById("audio");
    const grid = document.getElementById("grid");
    const player = document.getElementById("player");
    const search = document.getElementById("search");

    /* âœ… FIX: start idle (no default selection) */
    let currentSurah = null;      // null or 1..114
    let repeatOne = false;        // repeat current surah

    /* ===== URL builder (Full Surah) ===== */
    function surahUrl(n) {
      return `https://download.quranicaudio.com/qdc/mishari_al_afasy/murattal/${n}.mp3`;
    }

    /* ===== UI render ===== */
    function renderPlayer() {
      // âœ… Idle state UI (no surah selected yet)
      if (currentSurah == null) {
        player.innerHTML = `
      <div class="player-top">
        <div>
          <p class="track-title">Select a Surah to begin</p>
          <p class="track-sub">Tap any Surah below to start listening.</p>
        </div>
        <div class="pill" title="Playback options">
          <span>Mode:</span>
          <strong>Surah</strong>
        </div>
      </div>

      <div class="bar" title="Seek">
        <div class="fill" style="width:0%"></div>
      </div>

      <div class="time">
        <span>0:00</span>
        <span>0:00</span>
      </div>

      <div class="controls">
        <button class="btn" title="Previous" disabled style="opacity:.5;cursor:not-allowed">â®</button>
        <button class="btn btn-play" title="Play" disabled style="opacity:.5;cursor:not-allowed">â–¶</button>
        <button class="btn" title="Next" disabled style="opacity:.5;cursor:not-allowed">â­</button>
        <button class="btn" title="Repeat" disabled style="opacity:.5;cursor:not-allowed">ğŸ”</button>
        <button class="btn btn-wide" title="Download" disabled style="opacity:.5;cursor:not-allowed">â¬‡ Download</button>
      </div>
    `;
        return;
      }

      const [en, ar] = surahs[currentSurah - 1];

      player.innerHTML = `
    <div class="player-top">
      <div>
        <p class="track-title">${currentSurah}. ${en}</p>
        <p class="track-sub">${ar} â€¢ Mishary Al-Afasy</p>
      </div>
      <div class="pill" title="Playback options">
        <span>Mode:</span>
        <strong>Surah</strong>
      </div>
    </div>

    <div class="bar" id="bar" title="Seek">
      <div class="fill" id="fill"></div>
    </div>

    <div class="time">
      <span id="cur">0:00</span>
      <span id="dur">0:00</span>
    </div>

    <div class="controls">
      <button class="btn" id="prevBtn" title="Previous Surah" ${currentSurah === 1 ? "disabled style='opacity:.6;cursor:not-allowed'" : ""}>â®</button>
      <button class="btn btn-play" id="playBtn" title="Play/Pause">â–¶</button>
      <button class="btn" id="nextBtn" title="Next Surah" ${currentSurah === 114 ? "disabled style='opacity:.6;cursor:not-allowed'" : ""}>â­</button>

      <button class="btn ${repeatOne ? "btn-active" : ""}" id="repeatBtn" title="Repeat One">ğŸ”</button>
      <button class="btn btn-wide" id="downloadBtn" title="Download this Surah">â¬‡ Download</button>
    </div>
  `;

      // wire events
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");

      if (prevBtn && !prevBtn.disabled) prevBtn.onclick = prevSurah;
      if (nextBtn && !nextBtn.disabled) nextBtn.onclick = nextSurah;

      document.getElementById("playBtn").onclick = togglePlayPause;
      document.getElementById("repeatBtn").onclick = toggleRepeat;
      document.getElementById("downloadBtn").onclick = () => downloadSurah(currentSurah);
      document.getElementById("bar").onclick = seek;

      // reflect current play state on re-render
      syncPlayIcon();
      // reflect duration if already known
      const dur = document.getElementById("dur");
      if (dur && audio.duration) dur.textContent = formatTime(audio.duration);
    }

    function renderGrid(numbers) {
      grid.innerHTML = numbers.map(n => {
        const [en, ar] = surahs[n - 1];
        return `
      <div class="card" data-surah="${n}" onclick="playSurah(${n})">
        <div class="num">${n}</div>
        <h3>${en}</h3>
        <div class="ar">${ar}</div>
        <div class="meta">Tap to play</div>
      </div>
    `;
      }).join("");
      highlightPlayingCard();
    }

    function highlightPlayingCard() {
      document.querySelectorAll(".card").forEach(c => c.classList.remove("playing"));
      if (currentSurah == null) return;
      document.querySelector(`.card[data-surah="${currentSurah}"]`)?.classList.add("playing");
    }

    /* ===== Playback controls ===== */
    function playSurah(n) {
      const isSameSurah = (currentSurah === n);

      currentSurah = n;
      renderPlayer();
      highlightPlayingCard();

      // âœ… FIX: if same surah tapped again, force restart
      audio.pause();
      audio.currentTime = 0;

      audio.src = surahUrl(n);
      audio.load();

      // Called from user click â†’ safe to call play()
      audio.play().catch(() => {
        // If any browser blocks (unlikely here), user can press play
        syncPlayIcon();
      });
    }

    function togglePlayPause() {
      if (currentSurah == null) return;

      if (audio.paused) {
        audio.play().catch(() => { });
      } else {
        audio.pause();
      }
    }

    function nextSurah() {
      if (currentSurah == null) return;
      if (currentSurah < 114) {
        playSurah(currentSurah + 1);
      }
    }

    function prevSurah() {
      if (currentSurah == null) return;
      if (currentSurah > 1) {
        playSurah(currentSurah - 1);
      }
    }

    function toggleRepeat() {
      repeatOne = !repeatOne;
      const repeatBtn = document.getElementById("repeatBtn");
      if (repeatBtn) repeatBtn.classList.toggle("btn-active", repeatOne);
    }

    /* ===== Audio events: keep icons always correct ===== */
    function syncPlayIcon() {
      const playBtn = document.getElementById("playBtn");
      if (!playBtn) return;
      playBtn.textContent = audio.paused ? "â–¶" : "â¸";
    }

    audio.onplay = () => syncPlayIcon();
    audio.onpause = () => syncPlayIcon();

    audio.onended = () => {
      if (currentSurah == null) return;

      if (repeatOne) {
        audio.currentTime = 0;
        audio.play().catch(() => { });
      } else {
        if (currentSurah < 114) {
          playSurah(currentSurah + 1);
        } else {
          syncPlayIcon();
        }
      }
    };

    audio.onloadedmetadata = () => {
      const dur = document.getElementById("dur");
      if (dur) dur.textContent = formatTime(audio.duration);
    };

    audio.ontimeupdate = () => {
      const cur = document.getElementById("cur");
      const fill = document.getElementById("fill");
      if (cur) cur.textContent = formatTime(audio.currentTime);
      if (fill && audio.duration) {
        fill.style.width = (audio.currentTime / audio.duration * 100) + "%";
      }
    };

    /* ===== Seek ===== */
    function seek(e) {
      if (!audio.duration) return;
      const rect = e.currentTarget.getBoundingClientRect();
      const pct = (e.clientX - rect.left) / rect.width;
      audio.currentTime = Math.max(0, Math.min(audio.duration, pct * audio.duration));
    }

    /* ===== Download ===== */
    function downloadSurah(n) {
      const a = document.createElement("a");
      a.href = surahUrl(n);
      a.download = `surah-${n}.mp3`;
      document.body.appendChild(a);
      a.click();
      a.remove();
    }

    /* Helpers */
    function formatTime(sec) {
      if (!sec || isNaN(sec)) return "0:00";
      const m = Math.floor(sec / 60);
      const s = Math.floor(sec % 60);
      return `${m}:${String(s).padStart(2, "0")}`;
    }

    /* ===== Search ===== */
    search.oninput = (e) => {
      const q = e.target.value.trim().toLowerCase();

      // numeric direct
      const n = Number(q);
      if (q && !isNaN(n) && n >= 1 && n <= 114) {
        renderGrid([n]);
        return;
      }

      const matched = [];
      for (let i = 1; i <= 114; i++) {
        const en = surahs[i - 1][0].toLowerCase();
        if (!q || en.includes(q)) matched.push(i);
      }
      renderGrid(matched);
    };

    /* ===== Init ===== */
    renderPlayer(); // idle UI
    renderGrid(Array.from({ length: 114 }, (_, i) => i + 1));
  </script>

</body>

</html>